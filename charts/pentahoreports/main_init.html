<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<link type="text/css" href="/js/jquery/css/smoothness/jquery-ui-1.7.2.custom.css" rel="stylesheet" />
<link type="text/css" href="/skins/{SYS_SKIN}/style.css" rel="stylesheet" />
<link type="text/css" href="/css/classic.css" rel="stylesheet" />
<script type="text/javascript" src="/js/jquery/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="/js/jquery/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="/js/jquery/jquery.layout-latest.js"></script>

<style>
.submenu{
  text-align: left;
  font-weight: normal;
}
.submenu table{
  width: 100%;
  border-spacing: 0px;
}
.submenu tr{
  cursor: pointer;
}
.menuRow{
    background-color:#FFF;
}
.menuRowSelected{
    background-color:#FFF;
}
.menuRowPointer{
    background-color:#E0EAEF;
}
.submenu a{
    color:#2078A8;
    text-decoration:none;
    font-size: 11px;
}

#mainMenu {
    padding: 4px;
    padding-left: 1px;
    font-size: 12px;
    overflow: hidden;
}

#mainMenu a {
    padding: 4px;
    padding-left: 1px;
    font-size: 12px;
}
.xpadding{
   padding:5px;
   overflow: hidden;
}

#paneEastNorthContent,
#paneEastSouthContent,
#paneEastCenterContent,
#paneCenterContent{
    overflow: auto;
}

#loadPage{
    position: absolute;
    top: 200px;
    left: 200px;
}
.content {
    padding:  0px;
    position: relative;
    overflow: none;
}
</style>


<script type="text/javascript">
  var IS_FIREFOX
  var outerLayout, innerLayout;

  $(document).ready( function() {
    var layoutSettings_Outer = {
        name: "outerLayout" // NO FUNCTIONAL USE, but could be used by custom code to 'identify' a layout
        // options.defaults apply to ALL PANES - but overridden by pane-specific settings
    , defaults: {
            size:         "auto"
        , minSize:        50
        , paneClass:        "pane"    // default = 'ui-layout-pane'
        , resizerClass:     "resizer" // default = 'ui-layout-resizer'
        , togglerClass:     "toggler" // default = 'ui-layout-toggler'
        , buttonClass:      "button"  // default = 'ui-layout-button'
        , contentSelector:    ".content"  // inner div to auto-size so only it scrolls, not the entire pane!
        , contentIgnoreSelector:  "span"    // 'paneSelector' for content to 'ignore' when measuring room for content
        , togglerLength_open:   35      // WIDTH of toggler on north/south edges - HEIGHT on east/west edges
        , togglerLength_closed: 35      // "100%" OR -1 = full height
        , hideTogglerOnSlide:   true    // hide the toggler when pane is 'slid open'
        , togglerTip_open:    "Close This Pane"
        , togglerTip_closed:    "Open This Pane"
        , resizerTip:       "Resize This Pane"
        //  effect defaults - overridden on some panes
        , fxName:         "slide"   // none, slide, drop, scale
        , fxSpeed_open:     750
        , fxSpeed_close:      1500
        , fxSettings_open:    { easing: "easeInQuint" }
        , fxSettings_close:   { easing: "easeOutQuint" }
    }
    , north: {
            spacing_open:     1     // cosmetic spacing
        , togglerLength_open:   0     // HIDE the toggler button
        , togglerLength_closed: -1      // "100%" OR -1 = full width of pane
        , resizable:        false
        , slidable:       false
        //  override default effect
        , fxName:         "none"
        }
    , south: {
            maxSize:        200
        , spacing_closed:     0     // HIDE resizer & toggler when 'closed'
        , slidable:       false   // REFERENCE - cannot slide if spacing_closed = 0
        , initClosed:       true
       
        }
    , west: {
        size:         360
        , spacing_closed:     12      // wider space when closed
        , togglerLength_closed: 12      // make toggler 'square' - 21x21
        , togglerAlign_closed:  "top"   // align to top of resizer
        , togglerLength_open:   0     // NONE - using custom togglers INSIDE west-pane
        , togglerTip_open:    "Close West Pane"
        , togglerTip_closed:    "Open West Pane"
        , resizerTip_open:    "Resize West Pane"
        , slideTrigger_open:    "slide"   // default
        , initClosed:       false
        //  add 'bounce' option to default 'slide' effect
        , fxSettings_open:    { easing: "easeOutBounce" }
        }
    , east: {
            size:         320
        , spacing_closed:     21      // wider space when closed
        , togglerLength_closed: 21      // make toggler 'square' - 21x21
        , togglerAlign_closed:  "top"   // align to top of resizer
        , togglerLength_open:   0       // NONE - using custom togglers INSIDE east-pane
        , togglerTip_open:    "Close East Pane"
        , togglerTip_closed:    "Open East Pane"
        , resizerTip_open:    "Resize East Pane"
        , slideTrigger_open:    "click" //slide
        , initClosed:       true
        //  override default effect, speed, and settings
        , fxName:         "drop"
        , fxSpeed:        "normal"
        , fxSettings:       { easing: "easeOutBounce" } // nullify default easing
        ,   onshow_start:     showUpdatedTriggers
        ,   onopen_start:     function () {  }


        }
    , center: {
            paneSelector:     ".ui-layout-center"       // sample: use an ID to select pane instead of a class
        , onresize:       "innerLayout.resizeAll" // resize INNER LAYOUT when center pane resizes
        , minWidth:       200
        , minHeight:        200
        }
    };
    // create the OUTER LAYOUT
    outerLayout = $("#mainPane").layout( layoutSettings_Outer );

    innerLayout = $('#paneEastContent').layout({
      center__paneSelector: ".inner-center"
    , west__paneSelector:   ".inner-west"
    , east__paneSelector:   ".inner-east"
    , north__size:        170
    , south__size:        170
    , spacing_open:     4  // ALL panes
    , spacing_closed:     4  // ALL panes
    , west__spacing_closed: 6
    , east__spacing_closed: 6
    });

        //erik 1
    var westSelector = "#mainPane > .ui-layout-west"; // outer-west pane
    var eastSelector = "#mainPane > .ui-layout-east"; // outer-east pane

     // CREATE SPANs for pin-buttons - using a generic class as identifiers
    $("<span></span>").addClass("pin-button").prependTo( westSelector );
    $("<span></span>").addClass("pin-button").prependTo( eastSelector );
    // BIND events to pin-buttons to make them functional
    outerLayout.addPinBtn( westSelector +" .pin-button", "west");
    outerLayout.addPinBtn( eastSelector +" .pin-button", "east" );

     // CREATE SPANs for close-buttons - using unique IDs as identifiers
    $("<span></span>").attr("id", "west-closer" ).prependTo( westSelector );
    $("<span></span>").attr("id", "east-closer").prependTo( eastSelector );
    // BIND layout events to close-buttons to make them functional
    outerLayout.addCloseBtn("#west-closer", "west");
    outerLayout.addCloseBtn("#east-closer", "east");

    //***//
    var sClientbrowser = navigator.userAgent.toLowerCase();
    IS_FIREFOX = false;

    if (sClientbrowser.indexOf('firefox') != -1){
        IS_FIREFOX = true;
    }
    /*$("#mainMenu").accordion({
        fillSpace:!IS_FIREFOX, autoHeight: false
    });*/

    outerLayout.hide('east');

  });

  function showUpdatedTriggers(){
     // alert('showing triggers');
  }

  var PANEL_EAST_OPEN = false;


</script>

</head>
<body>

<div id="mainPane" style="width:100%; height:481px" class="panel_modal___processmaker">
  <div class="ui-layout-west" id="menuPane">
    <!--<iframe name="menuPentaho" id="menuPentaho" src="pentahoReportsMenu" width="99%" height="510" frameborder="0">
        <p>Your browser does not support iframes.</p>
    </iframe>-->
    <div class="ui-accordion-header ui-helper-reset ui-state-active ui-corner-all">
       <h3 class="ui-accordion-header ui-helper-reset ui-state-default ui-corner-all">
       <table class="" cellspacing="0" cellpadding="2" border="0" width="100%">
         <tr>
           <td align="center">Pentaho Reports Repository</td>
           <td align="left"><a href="#" class="submenu" style="color:blue;" onClick="openReportFolder('0','0');">Refresh</a></td>
         </tr>
       </table>
       </h3>
     </div>
     
     <div id="mainMenu">
          <div class="ui-accordion-header ui-helper-reset ui-state-active ui-corner-all xpadding">
            <div class="submenu" >
              <div id='child_0'></div>
            </div>
          </div>
      </div>

  </div>

  <div class="ui-layout-east" id="paneEastContent">
    <div class="inner-center"    id="paneEastCenterContent"></div>
    <div class="ui-layout-north" id="paneEastNorthContent"></div>
    <div class="ui-layout-south" id="paneEastSouthContent"></div>
  </div>

  <div class="ui-layout-south"></div>
  <div class="ui-layout-center">
     <div id="librariesLoader" style='display:none;' width="0" heigth="0"></div>
     <div id="spanFolderContent">Please Select a Report from the Repository</div>
  </div>
</div>
</body>
<script>
if (parent.getBrowserClient){
  var sClientbrowser = parent.getBrowserClient();
}
function setRowClass (theRow, thePointerClass){
  if (thePointerClass == '' || typeof(theRow.className) == 'undefined') {
      return false;
  }

  if( theRow.className != 'ui-accordion-header ui-helper-reset ui-state-default ui-corner-all' )
      theRow.className = thePointerClass;

  return true;
}


//MSIE adapting the interface
if(sClientbrowser.browser == 'msie'){
    oDivsSubMenusIE = document.getElementsByTagName('div');
    for(i=0; i<oDivsSubMenusIE.length; i++){
        if(oDivsSubMenusIE[i].className == 'ui-accordion-header ui-helper-reset ui-state-active ui-corner-all xpadding'){
            oDivsSubMenusIE[i].style.width = '260px';
        }
    }

}

//resize the div like arent frame
function autoResizeScreen(){
  oParentFrame = parent.document.getElementById('casesFrame');
  oCasesSubFrame = document.getElementById('casesSubFrame');
  oCasesFrame = document.getElementById('mainPane');
  height = oParentFrame.style.height.substring(0, oParentFrame.style.height.length-2);
  oCasesFrame.style.height = height-10;
  oCasesSubFrame.style.height = height-20;
}
/**
 * opens a report folder
 */
function openReportFolder( uid, rootfolder ){
    if (navigator.appName!='Microsoft Internet Explorer'){
      innerHeight = window.innerHeight;
      document.getElementById('menuPane').setAttribute( 'height' , innerHeight );
      window.parent.document.getElementById('casesFrame').setAttribute( 'style' , 'height:' + innerHeight + ';' );
      document.getElementById('mainPane').setAttribute( 'style' , 'width:100%; height:' + innerHeight-5 + ';' );
    } else {
      innerHeight = document.body.offsetHeight-5;      
      document.getElementById('mainPane').style.height=innerHeight;
      document.getElementById('menuPane').style.height=innerHeight;            
    }
    currentFolder = uid;
    if((document.getElementById('child_'+uid).innerHTML!="")&&(uid!=rootfolder)){
      document.getElementById('child_'+uid).innerHTML="";
      getPMFolderContent(uid);
      return;
    }
    document.getElementById('child_'+uid).innerHTML = "<img src='/js/maborak/core/images/loader_B.gif' >";
    $.ajax({
        type: "POST",
        url: "pentahoReportsListAjax",
        data: 'action=openReportFolder&folderID=' + uid + '&rootfolder=' + rootfolder,
        success: function(response){
            document.getElementById('child_'+uid).innerHTML = response;
        }
    });
    
}

function elementExists(element){
	if (element!=undefined)	{
		return true;	
	} else {
		return false;
	}
}
/**
 * opens a pentaho report
 */
function openReport( reportFilePath, reportFileName ){
    
    reportFullFilePath = reportFilePath+reportFileName;
 
    document.getElementById('spanFolderContent').innerHTML = "<img src='/js/maborak/core/images/loader_B.gif' >";//"Loading..";

    $.ajax({
        type: "POST",
        url: "pentahoReportsListAjax",
        data: 'action=openReport&filePath=' + reportFilePath + '&fileName=' + reportFileName,
        success: function(response){
            divWidth = 'width:'+(screen.width-420)+'; ';
            var innerHeight;
            document.getElementById('spanFolderContent').innerHTML = response;
    	      if (navigator.appName!='Microsoft Internet Explorer'){
                innerHeight = window.innerHeight;
                document.getElementById('spanFolderContent').setAttribute('style',divWidth);
                document.getElementById('mainPane').setAttribute( 'style' , 'width:100%; height:' + innerHeight-5 + ';' );
		document.getElementById('reportContentFrame').setAttribute('height', innerHeight-5);

              } else {
                innerHeight = document.body.offsetHeight-5;
                document.getElementById('mainPane').style.height=innerHeight;
                document.getElementById('reportContentFrame').height = innerHeight;
              }

        }
    });

}
/** 
 * toogles the content of a folder
 */
function toggleShowFolderContent( folderName, rootfolder ){
	uid = "child_"+folderName;
	arrowId = "arrow_"+folderName;
	folderElement = document.getElementById(uid);
	arrowElement  = document.getElementById(arrowId);
	
	hiddenStatus = folderElement.style.display;
	if (hiddenStatus==''){
		folderElement.setAttribute('style','display:none;');		
		folderElement.style.display='none';
		  if (elementExists(arrowElement))
		    document.getElementById(arrowId).innerHTML='&#9658;';
	}
  else { 	
    folderElement.setAttribute('style','');
  	folderElement.style.display='';
  	  if (elementExists(arrowElement))
  	    document.getElementById(arrowId).innerHTML='&#9660;';
  }

}

function toggleTree(){
	divWidth = screen.width-420;
	divWidthAlt = screen.width-50;

	if (document.getElementById('publisherContent[0]').style.display!='none'||document.getElementById('publisherContent[0]').style.display==undefined){
	  document.getElementById('publisherContent[0]').parentNode.style.width="0px"; 
  	  document.getElementById('publisherContent[0]').style.display='none';
  	  document.getElementById('spanFolderContent').style.width=divWidthAlt;
  	}	else { 		
  	  document.getElementById('publisherContent[0]').parentNode.style.width="270px";	 
  	  document.getElementById('publisherContent[0]').style.display='inline';
  	  document.getElementById('spanFolderContent').style.width=divWidth;
  	} 	  
}



window.onload = startPentahoReportsDir;
function startPentahoReportsDir(){
    $.ajax({
        type: "POST",
        async : false,
        url : "pentahoReportsListAjax",
        data: 'action=loadLibs',
        success: function(response){
          if (navigator.appName=='Microsoft Internet Explorer'){
            document.getElementById('librariesLoader').innerHTML = "<iframe src='"+response+"' width='0' height='0'>";
          }
        }
    });
    openReportFolder('0','0');
}





</script>
</html> 
